<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>如何写一个npm包 | 咸鱼老弟</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">如何写一个npm包</h1><a id="logo" href="/.">咸鱼老弟</a><p class="description">【博客园-咸鱼老弟】</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/resource/"><i class="fa fa-university"> 资源</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">如何写一个npm包</h1><div class="post-meta">Feb 25, 2018<script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-初始化一个项目"><span class="toc-number">1.</span> <span class="toc-text">1. 初始化一个项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-添加我们的代码"><span class="toc-number">2.</span> <span class="toc-text">2. 添加我们的代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-完善你的package-json文件"><span class="toc-number">3.</span> <span class="toc-text">3. 完善你的package.json文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-添加LICENCE文件，说明对应的开源协议"><span class="toc-number">4.</span> <span class="toc-text">4. 添加LICENCE文件，说明对应的开源协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-添加-README-md-文件-和-gitignore"><span class="toc-number">5.</span> <span class="toc-text">5. 添加 README.md 文件 和 .gitignore</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-发布npm包"><span class="toc-number">6.</span> <span class="toc-text">6. 发布npm包</span></a></li></ol></div></div><div class="post-content"><blockquote>
<p>一直想学习一下如何写一个npm包，奈何一直拖拖拖，今天开始行动，此文用于记录一下写npm包的过程。当然，网上也有很多类似的课程可找</p>
</blockquote>
<a id="more"></a>
<p>我们今天要写的一个npm包的主要作用是用于判断用户是否登录了,由于我们是写来玩的，所以暂且给它起名为：<code>is-login-test</code></p>
<p>下面开始我们的npm包的制作过程</p>
<h2 id="1-初始化一个项目"><a href="#1-初始化一个项目" class="headerlink" title="1. 初始化一个项目"></a>1. 初始化一个项目</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir is-login-test</span><br><span class="line"><span class="built_in">cd</span> is-login-test</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure>
<p>一路回车即可</p>
<h2 id="2-添加我们的代码"><a href="#2-添加我们的代码" class="headerlink" title="2. 添加我们的代码"></a>2. 添加我们的代码</h2><p>新建<code>index.js</code>文件。我们的这个npm包是判断用户是否登录了，所以我们的代码也比较简单</p>
<p>代码如下:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> options = options || &#123;&#125;;</span><br><span class="line">    <span class="keyword">const</span> sessionName = options[<span class="string">"sessionName"</span>] || <span class="string">"user"</span>;</span><br><span class="line">    <span class="keyword">const</span> redirect = options[<span class="string">"redirect"</span>] || <span class="string">"/login"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!req.session[sessionName]) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.redirect(redirect);</span><br><span class="line">        &#125;</span><br><span class="line">        next();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>代码比较简单，默认session的名字为user,如果没有登录，则默认转到<code>/login</code>这个路由,也可以自定义session的名字以及自定义未登录时跳转的路由</p>
<h2 id="3-完善你的package-json文件"><a href="#3-完善你的package-json文件" class="headerlink" title="3. 完善你的package.json文件"></a>3. 完善你的package.json文件</h2><p>这一步也可以在初始化项目的时候完成，看个人喜欢</p>
<p><code>name</code>：包的名字，确保该名字是独一无二的<br><code>version</code>：包的版本，默认是1.0.0<br><code>description</code>：包的描述<br><code>main</code>：入口文件，默认是index.js<br><code>test command</code>：测试命令<br><code>repository</code>：git仓库地址,一般为”type”:”git”,”url”:”git的url”<br><code>keyword</code>：这个挺重要，尽量用比较贴切的关键字作为这个包的索引，这样才能有更多的人搜索到你的包<br><code>author</code>：写你的账号或者你的github账号吧<br><code>license</code>：开源协议用了哪个</p>
<h2 id="4-添加LICENCE文件，说明对应的开源协议"><a href="#4-添加LICENCE文件，说明对应的开源协议" class="headerlink" title="4. 添加LICENCE文件，说明对应的开源协议"></a>4. 添加LICENCE文件，说明对应的开源协议</h2><p>可到<a href="https://spdx.org/licenses/" target="_blank" rel="noopener">SPDX License List</a> 或者 <a href="https://opensource.org/licenses/alphabetical" target="_blank" rel="noopener">Open Source Initiative</a> 下载相应协议的模板。这里我们选择的是MIT开源协议。</p>
<p>我们新建一个名为 <code>LICENSE</code> 的文件，并在里面粘贴进如下内容<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">The MIT License (MIT)</span><br><span class="line"></span><br><span class="line">Copyright (c) &lt;year&gt; <span class="xml"><span class="tag">&lt;<span class="name">copyright</span> <span class="attr">holders</span>&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span></span><br></pre></td></tr></table></figure></p>
<p>将<code>&lt;year&gt;</code> 和 <code>&lt;copyright holders&gt;</code>修改为 对应的年份 和 版权拥有者名字</p>
<h2 id="5-添加-README-md-文件-和-gitignore"><a href="#5-添加-README-md-文件-和-gitignore" class="headerlink" title="5. 添加 README.md 文件 和 .gitignore"></a>5. 添加 README.md 文件 和 .gitignore</h2><p>README.md 文件主要用于 该项目的一些说明，使用方法等<br>在一些npm包中的README.md中，会看到类似于下图好看的版本信息<br><img src="/img/npm-icon.png" alt="icon"><br>这些版本信息图标可以在 <a href="https://shields.io" target="_blank" rel="noopener">https://shields.io</a> 制作<br>登录该网站，拉到最下面<br><img src="/img/p25.jpg" alt="icon">输入对应 文字，版本号即可 <img src="/img/p26.jpg" alt="icon"></p>
<p>.gitignore主要用于忽略不需要提交的文件更改。可以去<a href="https://github.com/github/gitignore" target="_blank" rel="noopener">gitignore</a>下载对应的模板，然后自己修改修改</p>
<h2 id="6-发布npm包"><a href="#6-发布npm包" class="headerlink" title="6. 发布npm包"></a>6. 发布npm包</h2><ol>
<li><p>首先到 <a href="https://www.npmjs.com" target="_blank" rel="noopener">https://www.npmjs.com</a> 上注册一个账号</p>
</li>
<li><p>在你需要发布的项目文件中，终端输入 <code>npm adduser</code>,然后按照提示，输入对应的用户名，密码，邮箱即可。<br>这里需要注意，你的镜像必须是npm，而不是cnpm，可以使用nrm来管理你的镜像。登录之后，可以终端输入<code>npm whoami</code>,如果出现你的名字，那就说明登录成功了。</p>
</li>
<li><p>最后输入<code>npm publish --access=public</code>,即可发布成功。如果有报错，那可能你的包名被人占用了，换个名字吧</p>
</li>
<li><p>在你的电脑上，直接<code>npm install 你的包名</code>，来看看你的包是否发布成功了。当然，也可以在<a href="https://www.npmjs.com" target="_blank" rel="noopener">https://www.npmjs.com</a>这里查找你发布的包</p>
</li>
<li><p>如果你要更新你的npm包，记得修改package.json的版本号，而且一般比上一个版本要高一点，否则会报错</p>
</li>
</ol>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="https://xianyulaodi.github.io/2018/02/25/如何写一个npm包/" data-id="cje8p101s0010jkp690nzax1n" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACwUlEQVR42u3c0WrbQBAFUP//T6fQp5Ri9d6ZXZzC0VNwrJWOAt7xnSGvV3x8/T6+//z9SF5/Xu35un+vefjAw8PDG936u+P5hp5vPT/3HSB/lG8fAR4eHt41XrIZPAPadZJz2+0EDw8P76fx2g/oUyvj4eHh/b+85P15ZJA8Djw8PLyfzEvCiDZ6SC6/Dy+OZS14eHh4XZVbN8A++/P1/h4eHh7eqKvebhjJB3dSiG+Cjz/OwsPDw7vAm4UIm7GDtshu493XPiPBw8PDK2vR5OR8FKBtaG0aZlEggoeHh3eUl4e2+5h13/qqh7fw8PDwLvDaIapZK6sNNfJhhaiwxsPDw1vzZqVzHrkmZfdmzSjAxcPDw7vA2ze38rh2E8gmm0fU38PDw8Nb8/Iv8/kQwGyraAv9fzTV8PDw8C7wNsOpsxBhE0/k6+Ph4eHd4+Wt9zbMbV+fvafo6eHh4eEd5eWB6SyWzbeKWUhRZC14eHh4h3ibW9yMF7SBRX0WHh4e3gVeHkC0F2sjhlksW2wheHh4eJd5s0L2FRwttcW/fT8eHh7eUV7bZDoV7M42gLqkxsPDwzvKy4vadqSgXeHK/eDh4eF95qNu+G/yhmHrolhvvwzg4eHhbXjPN50/lX0k0YYX0XaCh4eHd4HXhqqzgGAWNOTBR/Q3xMPDw7vAy5th7bjVrCxuh8BWKQgeHh5ezNsPhuZbQvLbNsyN2mB4eHh413iz6YPnV9r1h3nzu/IdDw8P7yjvqzxOhb+zLaEd88LDw8O7wZs14/OieRMrtAX9KgrBw8PDK++hbX3lQ1T5h3teuCcDXqvOHh4eHl7MO7UZJIVyXqAP8xU8PDy8H89rt4rZSFZOKvp7eHh4eJd57ehA/jjah3ilpMbDw8O7EEYkZe6sDdZeHQ8PD++zvLYBdi+22DTMhp09PDw8vI73C+S0nHGSPTNMAAAAAElFTkSuQmCC" class="article-share-link">分享</a><div class="tags"><a href="/tags/npm/">npm</a></div><div class="post-nav"><a href="/2018/02/10/BigPipe小探/" class="next">BigPipe小探</a></div><div id="container"></div><link rel="stylesheet" href="/css/default.css?v=0.0.0"><script src="/js/gitment.browser.js?v=0.0.0"></script><script>var gitment = new Gitment({
  owner: 'xianyulaodi',
  repo: 'myBlogCommentRepo',
  oauth: {
    client_id: 'bb8f1145bdd0717d9830',
    client_secret: 'b18dc8d3b04cea043cb47d083049276cd93e0503',
  },
})
gitment.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://xianyulaodi.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/js/">js</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/github/" style="font-size: 15px;">github</a> <a href="/tags/js/" style="font-size: 15px;">js</a> <a href="/tags/高阶函数/" style="font-size: 15px;">高阶函数</a> <a href="/tags/BigPipe/" style="font-size: 15px;">BigPipe</a> <a href="/tags/博客园迁移/" style="font-size: 15px;">博客园迁移</a> <a href="/tags/cookie/" style="font-size: 15px;">cookie</a> <a href="/tags/expess/" style="font-size: 15px;">expess</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/node/" style="font-size: 15px;">node</a> <a href="/tags/path/" style="font-size: 15px;">path</a> <a href="/tags/mongoose/" style="font-size: 15px;">mongoose</a> <a href="/tags/fs/" style="font-size: 15px;">fs</a> <a href="/tags/setTimeout/" style="font-size: 15px;">setTimeout</a> <a href="/tags/Eventloop/" style="font-size: 15px;">Eventloop</a> <a href="/tags/npm/" style="font-size: 15px;">npm</a> <a href="/tags/vue/" style="font-size: 15px;">vue</a> <a href="/tags/vuex/" style="font-size: 15px;">vuex</a> <a href="/tags/vue-router/" style="font-size: 15px;">vue-router</a> <a href="/tags/router/" style="font-size: 15px;">router</a> <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/正则/" style="font-size: 15px;">正则</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/02/25/如何写一个npm包/">如何写一个npm包</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/10/BigPipe小探/">BigPipe小探</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/22/将中文转为拼音首字母/">js提取中文拼音首字母</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/29/给女朋友写的一个简书爬虫/">给女朋友写的一个简书爬虫</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/24/nodejs学习小结/">nodejs学习小结</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/12/express图片上传/">express图片上传</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/19/浅析css中的cursor/">浅析css中的cursor</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/03/javascript高阶函数/">javascript高阶函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/18/手写一个router/">手写一个router</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/30/正则表达式学习/">正则表达式学习</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-money"> 请博主喝咖啡</i><img src="/img/WeChatQR.png"/></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.cnblogs.com/xianyulaodi/" title="我的博客园" target="_blank">我的博客园</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">咸鱼老弟.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>